"actionType": "NOTIFICATION",
            "args": {
              "frenchNotificationTemplate": {
                "smsTemplate": 
                
                "Cher ${APPLICANT_LAST_NAME},Votre demande de: Nationalité rwandaise par acquisition 
                pour cause d'adoption avec le numéro de facturation ${billId} a été soumise avec
                 succès! Frais à payer: 10,000 FRW, Payez avant: ${paymentExpiryDate} For support, call 9099",

                "emailTemplate":
                
                 "Cher ${APPLICANT_LAST_NAME},Votre demande de:
                 Nationalité rwandaise par acquisition pour cause d'adoption avec 
                 le numéro de facturation ${billId} a été soumise avec succès! 
                 Frais à payer: 10,000 FRW, Payez avant: ${paymentExpiryDate} For
                  support, call 9099",

                "notificationTitle": "Demande soumise"
              },
              "englishNotificationTemplate": {
                "smsTemplate": 
                
                "Dear ${APPLICANT_LAST_NAME}, Your application for: Rwandan nationality 
                by acquisition - adoption with billing number ${billId} was successfully submitted!
                 Fees to be paid: 10,000 RWF, Pay Before: ${paymentExpiryDate}. For support, call 9099",

                "emailTemplate": 
                
                "Dear ${APPLICANT_LAST_NAME}, Your application for: Rwandan nationality 
                by acquisition - adoption with billing number ${billId} was successfully submitted! Fees 
                to be paid: 10,000 RWF, Pay Before: ${paymentExpiryDate}. For support, call 9099",

                "notificationTitle": "Application submitted"
              },
              "kinyarwandaNotificationTemplate": {
                "smsTemplate": 
                
                "Kuri ${APPLICANT_LAST_NAME},Dosiye yawe isaba: Ubwenegihugu bw'u Rwanda 
                binyuze mu kurera ifite kode yo kwishyura ${billId} yoherejwe neza! Amafaranga yishyurwa:
                 10,000 FRW Ishyura mbere ya: ${paymentExpiryDate}. Mukeneye ubundi bufasha, mwahamagara 9099",

                "emailTemplate": 
                
                "Kuri ${APPLICANT_LAST_NAME},Dosiye yawe isaba: Ubwenegihugu bw'u Rwanda 
                binyuze mu kurera ifite kode yo kwishyura ${billId} yoherejwe neza! Amafaranga yishyurwa:
                 10,000 FRW Ishyura mbere ya: ${paymentExpiryDate}. Mukeneye ubundi bufasha, mwahamagara 9099",

                "notificationTitle": "Dosiye yoherejwe"
              }
            }


            [
              {
                "id":1,
                "startState":"NEW",
                "event":"CREATE",
                "state":"PAYMENT_PENDING",
                "endStateOne":
                {
                  "stateName":"Payment_Pending",
                  "stateCode":"PAYMENT_PENDING",
                  "breakingAction":
                  {
                    "actionType":"BILL_ID_GENERATION",
                    "args":null
                    },
                    "nonBreakingActionList":
                    [
                      {
                        "actionType":"NOTIFICATION",
                        "args":
                        {
                          "frenchNotificationTemplate":
                          {
                            "smsTemplate":"Cher ${APPLICANT_LAST_NAME}, Votre demande de: Nationalité rwandaise par acquisition pour cause d'adoption avec le numéro de facturation ${billId} a été soumise avec succès! Frais à payer: 10,000 FRW, Payez avant: ${paymentExpiryDate} For support, call 9099",
                            "emailTemplate":"Cher ${APPLICANT_LAST_NAME},Votre demande de: Nationalité rwandaise par acquisition pour cause d'adoption avec le numéro de facturation ${billId} a été soumise avec succès! Frais à payer: 10,000 FRW, Payez avant: ${paymentExpiryDate} For support, call 9099",
                            "notificationTitle":"Demande soumise"
                            },
                            "englishNotificationTemplate":
                            {
                              "smsTemplate":"Dear ${APPLICANT_LAST_NAME}, Your application for: Rwandan nationality by acquisition - adoption with billing number ${billId} was successfully submitted! Fees to be paid: 10,000 RWF, Pay Before: ${paymentExpiryDate}. For support, call 9099",
                              "emailTemplate":"Dear ${APPLICANT_LAST_NAME}, Your application for: Rwandan nationality by acquisition - adoption with billing number ${billId} was successfully submitted! Fees to be paid: 10,000 RWF, Pay Before: ${paymentExpiryDate}. For support, call 9099",
                              "notificationTitle":"Application submitted"},
                              "kinyarwandaNotificationTemplate":
                              {
                                "smsTemplate":"Kuri ${APPLICANT_LAST_NAME}, Dosiye yawe isaba: Ubwenegihugu bw'u Rwanda binyuze mu kurera ifite kode yo kwishyura ${billId} yoherejwe neza! Amafaranga yishyurwa: 10,000 FRW Ishyura mbere ya: ${paymentExpiryDate}. Mukeneye ubundi bufasha, mwahamagara 9099",
                                "emailTemplate":"Kuri ${APPLICANT_LAST_NAME}, Dosiye yawe isaba: Ubwenegihugu bw'u Rwanda binyuze mu kurera ifite kode yo kwishyura ${billId} yoherejwe neza! Amafaranga yishyurwa: 10,000 FRW Ishyura mbere ya: ${paymentExpiryDate}. Mukeneye ubundi bufasha, mwahamagara 9099",
                                "notificationTitle":"Dosiye yoherejwe"
                                }
                                }
                                }
                                ]
                                },
                                "endStateTwo":null,
                                "breakingAction":"",
                                "nonBreakingAction":""
                                }
                                ]

                              [
                                {
                                  "id":1,
                                  "startState":"ssd",
                                  "event":"ds",
                                  "endStateOne":
                                  {
                                    "stateName":"ds",
                                    "stateCode":"ds",
                                    "breakingAction":null,
                                    "nonBreakingActionList":
                                    [
                                      {
                                        "actionType":"NOTIFICATION",
                                        "args":
                                        {
                                          "frenchNotificationTemplate":
                                          {
                                            "smsTemplate":"sd",
                                            "emailTemplate":"ds",
                                            "notificationTitle":"ds"
                                            },
                                            "englishNotificationTemplate":
                                            {
                                              "smsTemplate":"dsd",
                                              "emailTemplate":"ds","notificationTitle":"ds"},"kinyarwandaNotificationTemplate":{"smsTemplate":"ds","emailTemplate":"ds","notificationTitle":"ds"}}}]}}]

                                             [
                                              {
                                                "id":1,
                                                "startState":"NEW",
                                                "event":"CREATE",
                                                "state":"PAYMENT_PENDING",
                                                "endStateOne":
                                                {
                                                  "stateName":"Payment_Pending",
                                                  "stateCode":"PAYMENT_PENDING",
                                                  "breakingAction":
                                                  {
                                                    "actionType":"BILL_ID_GENERATION",
                                                    "args":null
                                                    },
                                                    "nonBreakingActionList":[{"actionType":"NOTIFICATION","args":{"frenchNotificationTemplate":{"smsTemplate":"Cher ${APPLICANT_LAST_NAME}, Votre demande de: Nationalité rwandaise par acquisition pour cause d'adoption avec le numéro de facturation ${billId} a été soumise avec succès! Frais à payer: 10,000 FRW, Payez avant: ${paymentExpiryDate} For support, call 9099","emailTemplate":"Cher ${APPLICANT_LAST_NAME},Votre demande de: Nationalité rwandaise par acquisition pour cause d'adoption avec le numéro de facturation ${billId} a été soumise avec succès! Frais à payer: 10,000 FRW, Payez avant: ${paymentExpiryDate} For support, call 9099","notificationTitle":"Demande soumise"},"englishNotificationTemplate":{"smsTemplate":"Dear ${APPLICANT_LAST_NAME}, Your application for: Rwandan nationality by acquisition - adoption with billing number ${billId} was successfully submitted! Fees to be paid: 10,000 RWF, Pay Before: ${paymentExpiryDate}. For support, call 9099","emailTemplate":"Dear ${APPLICANT_LAST_NAME}, Your application for: Rwandan nationality by acquisition - adoption with billing number ${billId} was successfully submitted! Fees to be paid: 10,000 RWF, Pay Before: ${paymentExpiryDate}. For support, call 9099","notificationTitle":"Application submitted"},"kinyarwandaNotificationTemplate":{"smsTemplate":"Kuri ${APPLICANT_LAST_NAME}, Dosiye yawe isaba: Ubwenegihugu bw'u Rwanda binyuze mu kurera ifite kode yo kwishyura ${billId} yoherejwe neza! Amafaranga yishyurwa: 10,000 FRW Ishyura mbere ya: ${paymentExpiryDate}. Mukeneye ubundi bufasha, mwahamagara 9099","emailTemplate":"Kuri ${APPLICANT_LAST_NAME}, Dosiye yawe isaba: Ubwenegihugu bw'u Rwanda binyuze mu kurera ifite kode yo kwishyura ${billId} yoherejwe neza! Amafaranga yishyurwa: 10,000 FRW Ishyura mbere ya: ${paymentExpiryDate}. Mukeneye ubundi bufasha, mwahamagara 9099","notificationTitle":"Dosiye yoherejwe"}}}]},"endStateTwo":null,"breakingAction":"","nonBreakingAction":""}]


                                                   [
                                                    {
                                                      "id":1,
                                                      "startState":"ds",
                                                      "event":"ds",
                                                      "state":"ds",
                                                      "endStateOne":
                                                      {
                                                        "stateName":"ds",
                                                        "stateCode":"ds",
                                                        "breakingAction":
                                                        {
                                                          "actionType":"ds"
                                                          },
                                                          "nonBreakingActionList":
                                                          [
                                                            {
                                                              "actionType":"NOTIFICATION",
                                                              "args":
                                                              {
                                                                "frenchNotificationTemplate":
                                                                {
                                                                  "smsTemplate":"dsd",
                                                                  "emailTemplate":"ds",
                                                                  "notificationTitle":"ds"
                                                                  },
                                                                  "englishNotificationTemplate":
                                                                  {
                                                                    "smsTemplate":"s",
                                                                    "emailTemplate":"dsd",
                                                                    "notificationTitle":"d"
                                                                    },
                                                                    "kinyarwandaNotificationTemplate":
                                                                    {
                                                                      "smsTemplate":"ds",
                                                                      "emailTemplate":"ds",
                                                                      "notificationTitle":"sd"
                                                                      }
                                                                      }
                                                                      },
                                                                      {
                                                                        "actionType":"NOTIFICATION",
                                                                        "args":
                                                                        {
                                                                          "frenchNotificationTemplate":
                                                                          {
                                                                            "smsTemplate":"ds",
                                                                            "emailTemplate":"ds",
                                                                            "notificationTitle":"ds"
                                                                            },
                                                                            "englishNotificationTemplate":
                                                                            {
                                                                              "smsTemplate":"d",
                                                                              "emailTemplate":"ds",
                                                                              "notificationTitle":"ds"
                                                                              },
                                                                              "kinyarwandaNotificationTemplate":
                                                                              {
                                                                                "smsTemplate":"ds",
                                                                                "emailTemplate":"ds",
                                                                                "notificationTitle":"sd"
                                                                                }
                                                                                }
                                                                                }
                                                                                ]
                                                                                }
                                                                                }
                                                                                ]




                                                                                <div class="modal-footer d-flex justify-content-end">
                                    <button type="button" class="btn btn-sm btn-success me-2" data-bs-dismiss="modal" (click)="saveFormData()">Create</button>
                                    <div class="btn btn-outline-danger btn-sm" data-bs-dismiss="modal">EXIT</div>
                                    <!-- <button type="button" class="btn btn-sm btn-info" (click)="saveFormData()">Save</button> -->
                                </div>

                                saveFormData() {
    try {
      const formValue = this.devForm.value;
      const existingData: Developer[] = JSON.parse(localStorage.getItem('iremboWorkflow') || '[]');
      const newData: Developer[] = [...existingData, ...formValue.devList.map((dev: any) => {
        // Ensure breakingAction is included even if it's null or empty
        if (!dev.endStateOne.breakingAction || !dev.endStateOne.breakingAction.actionType.trim()) {
          dev.endStateOne.breakingAction = null;
        }
        return dev;
      })];
      localStorage.setItem('iremboWorkflow', JSON.stringify(newData));
      localStorage.setItem('idCounter', this.idCounter.toString());
  
      // Automatically reload the page after 10 seconds
      setTimeout(() => {
        window.location.reload();
      }, 100);
    } catch (error) {
      console.error('Error saving form data:', error);
    }
  }

    saveFormData() {
    try {
      const formValue = this.devForm.value;
      const existingData: Developer[] = JSON.parse(localStorage.getItem('iremboWorkflow') || '[]');
      const newData: Developer[] = [...existingData, ...formValue.devList.map((dev: any) => {
        // Ensure breakingAction is included even if it's null or empty
        if (!dev.endStateOne.breakingAction || !dev.endStateOne.breakingAction.actionType.trim()) {
          dev.endStateOne.breakingAction = null;
        }
        return dev;
      })];
      localStorage.setItem('iremboWorkflow', JSON.stringify(newData));
      localStorage.setItem('idCounter', this.idCounter.toString());
    } catch (error) {
      console.error('Error saving form data:', error);
    }
  }

   <div formArrayName="nonBreakingActionList">
                                                    <div
                                                        *ngFor="let action of nonBreakingActionss(i).controls; let j = index;">
                                                        <div [formGroupName]="j">
                                        
                                                            <mat-expansion-panel hideToggle>
                                                                <mat-expansion-panel-header>
                                                                    <mat-panel-title> <button type="button"
                                                                            class="btn btn-sm btn-primary mt-4 mb-5">
                                                                            Non-Breaking Actions {{ j + 1
                                                                            }} </button> 
                                                                            </mat-panel-title>
                                                                </mat-expansion-panel-header>
                                                                <input type="text" formControlName="actionType"
                                                                    placeholder="* Non-breaking Action Type" />

                                                                <div formGroupName="args">
                                                                    <div formGroupName="frenchNotificationTemplate">
                                                                        <textarea formControlName="smsTemplate"
                                                                            placeholder="Frenchss SMS Template"></textarea>

                                                                            <textarea formControlName="smsTemplate">
                                                                                {{ dev.get('endStateOne.nonBreakingActionList').at(j).get('args.frenchNotificationTemplate.smsTemplate').value }}
                                                                            </textarea>

                                                                            <input type="text" formControlName="notificationTitle" placeholder="French Notification Title" />
                                                                    </div>
                                                                    <div formGroupName="englishNotificationTemplate">
                                                                        <textarea formControlName="endStateOne.nonBreakingActionList.controls[i].args.englishNotificationTemplate.smsTemplate"
                                                                        placeholder="English SMS Template"></textarea>
                                                                        <textarea formControlName="emailTemplate"
                                                                            placeholder="English Email Template"></textarea>
                                                                        <input type="text"
                                                                            formControlName="notificationTitle"
                                                                            placeholder="English Notification Title" />
                                                                    </div>
                                                                    <div
                                                                        formGroupName="kinyarwandaNotificationTemplate">
                                                                        <textarea formControlName="smsTemplate" class="textAreasss"
                                                                            placeholder="Kinyarwanda SMS Template"></textarea>
                                                                        <textarea formControlName="emailTemplate"
                                                                            placeholder="Kinyarwanda Email Template"></textarea>
                                                                        <input type="text"
                                                                            formControlName="notificationTitle"
                                                                            placeholder="Kinyarwanda Notification Title" />
                                                                    </div>
                                                                </div>
                                                                <button type="button"
                                                                    *ngIf="nonBreakingActionss(i).length > 1"
                                                                    class="btn btn-sm btn-danger ms-1"
                                                                    (click)="removeNonBreakingActions(i, j)">Remove</button>
                                                            </mat-expansion-panel>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>




                                                     <div class="d-flex justify-content-center">
                                <form [formGroup]="devForm" class=" p-5 mt-10" (ngSubmit)="onSubmit($event)">
                                    <div class="transition-container">
                                        <b class="new_transition mt-10">New Transition</b>
                                    </div>
                                    <mat-divider></mat-divider><br>
                                    <div formArrayName="devList">
                                        <div *ngFor="let developer of devListArray().controls; let i = index;">
                                            <div [formGroupName]="i">
                                                <input type="hidden" formControlName="id" />

                                                <input type="hidden" formControlName="id" />
                                                <table class="styled-table">
                                                    <tr>
                                                        <td class="label-cell">Start State</td>
                                                        <td>:</td>
                                                        <td>
                                                            <select class="select-field" formControlName="startState">
                                                                <option value="">------------Select---------</option>
                                                                <option
                                                                    *ngFor="let startState of getStateMachineComponentUniqueStartStates()"
                                                                    [value]="startState">
                                                                    {{ startState }}
                                                                </option>
                                                            </select>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td class="label-cell">Event</td>
                                                        <td>:</td>
                                                        <td>
                                                            <select class="select-field" formControlName="event">
                                                                <option value="">------------Select---------</option>
                                                                <option *ngFor="let event of getUniqueEvents()"
                                                                    [value]="event">
                                                                    {{ event }}
                                                            </select>
                                                        </td>
                                                    </tr>
                                                </table>
                                                <label class="styled-label">End State 1:</label>
                                                <div class="new_transition1">
                                                    <div formGroupName="endStateOne">
                                                        <table class="styled-table">
                                                            <tr>
                                                                <td class="label-cell">State</td>
                                                                &nbsp;&nbsp;&nbsp;&nbsp;
                                                                <td>:</td>&nbsp;
                                                                <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                                    <select class="select-field"
                                                                        formControlName="stateCode">
                                                                        <option value="">------------Select---------
                                                                        </option>
                                                                        <option
                                                                            *ngFor="let stateCode of getUniqueStateCodes()"
                                                                            [value]="stateCode">
                                                                            {{ stateCode }}
                                                                        </option>
                                                                    </select>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                        <div formGroupName="breakingAction">
                                                            <table class="styled-table">
                                                                <tr>
                                                                    <td class="label-cell">Breaking Action</td>
                                                                    <td>:</td>
                                                                    <td>
                                                                        <select class="select-field"
                                                                            formControlName="actionType">
                                                                            <option value="">------------Select---------
                                                                            </option>
                                                                            <option
                                                                                *ngFor="let breakingAction of getBreakingActions()"
                                                                                [value]="breakingAction">
                                                                                {{ breakingAction }}
                                                                            </option>
                                                                        </select>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                            <!-- Removed the args input field -->
                                                        </div>
                                                    </div>
                                                    <table class="styled-table">
                                                        <tr>
                                                            <td class="label-cell">Non-Breaking Actions</td>
                                                            <td>:</td>
                                                            <td>
                                                                <input type="text" class="select-fields"
                                                                    value="NOTIFICATION" readonly>
                                                            </td>
                                                            <td>
                                                                <button type="button" class="btn btn-sm btn-warning"
                                                                    (click)="addNonBreakingActionss(i)">Add</button>
                                                            </td>
                                                        </tr>
                                                    </table>

                                                    <div formArrayName="nonBreakingActionList">
                                                        <div *ngFor="let action of nonBreakingActionss(i).controls; let j = index;">
                                                          <div [formGroupName]="j">
                                                            <mat-expansion-panel hideToggle>
                                                              <mat-expansion-panel-header>
                                                                <mat-panel-title>Non-breaking Action {{ j + 1 }}</mat-panel-title>
                                                              </mat-expansion-panel-header>
                                                              <input type="text" formControlName="actionType" placeholder="* Non-breaking Action Type" />
                                          
                                                              <div formGroupName="args">
                                                                <div formGroupName="frenchNotificationTemplate">
                                                                  <textarea formControlName="smsTemplate" placeholder="French SMS Template"></textarea>
                                                                  <textarea formControlName="emailTemplate" placeholder="French Email Template"></textarea>
                                                                  <input type="text" formControlName="notificationTitle" placeholder="French Notification Title" />
                                                                </div>
                                                                <div formGroupName="englishNotificationTemplate">
                                                                  <textarea formControlName="smsTemplate" placeholder="English SMS Template"></textarea>
                                                                  <textarea formControlName="emailTemplate" placeholder="English Email Template"></textarea>
                                                                  <input type="text" formControlName="notificationTitle" placeholder="English Notification Title" />
                                                                </div>
                                                                <div formGroupName="kinyarwandaNotificationTemplate">
                                                                  <textarea formControlName="smsTemplate" placeholder="Kinyarwanda SMS Template"></textarea>
                                                                  <textarea formControlName="emailTemplate" placeholder="Kinyarwanda Email Template"></textarea>
                                                                  <input type="text" formControlName="notificationTitle" placeholder="Kinyarwanda Notification Title" />
                                                                </div>
                                                              </div>
                                                              <button type="button" *ngIf="nonBreakingActionss(i).length > 1" class="btn btn-sm btn-danger ms-1" (click)="removeNonBreakingActions(i, j)">Remove</button>
                                                            </mat-expansion-panel>
                                                          </div>
                                                        </div>
                                                        <button type="button" class="btn btn-sm btn-warning" (click)="addNonBreakingActionss(i)">+</button>
                                                      </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="modal-footer d-flex justify-content-end">
                                        <button type="button" class="btn btn-sm btn-success me-2"
                                            data-bs-dismiss="modal" (click)="saveFormData()">Create</button>
                                        <div class="btn btn-outline-danger btn-sm" data-bs-dismiss="modal">EXIT</div>
                                        <!-- <button type="button" class="btn btn-sm btn-info" (click)="saveFormData()">Save</button> -->
                                    </div>
                                </form>
                            </div>